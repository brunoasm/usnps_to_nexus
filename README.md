# unlinked_snps_to_nexus.py
A simple script that converts unlinked_snps files produced by [pyRAD](https://github.com/dereneaton/pyrad) to a NEXUS file suitable for SNAPP.

The input file is simply a phylip-formatted alignment in which heterozygous individuals are coded by ambiguities, missing data by N and gaps by -.

## Usage
To show help: `python unlinked_snps_to_nexus.py -h`

### Parameters
* Required: path to input alignment, usually a \*.unlinked_snps file generated by pyRAD
* Optional: **-p** path to \*.csv file containing population assignments. This file must contain a column named 'sample', with sample names as in the input file, and another named 'population', with population names. All samples in the input file must be in the population table. Other columns in this table are ignored.
In the NEXUS file produced, population will be appended to sample name, separated by underline. In BEAUTi, this can be used to quickly set populations by using button **GUESS**.

## Output
The program outputs a nexus file to the directory in which it is called, with same base name as input file. Sample names will contain populations if a population file is provided.

If any alignment column has more than 2 alleles, a warning is given and this column is ommited from output.

The most frequent allele in a column is coded as 0, the other allele as 2 and heterozygotes as 1. N's and -'s are converted to ? in the output.


## Example
```bash
python unlinked_snps_to_nexus.py my_file.unlinked_snps -p pop_table.csv
```
This will produce a file named **my_file.nex** in the current directory, which can be loaded by BEAUTi.

## Required python libraries.
These libraries need to be installed to use this script:
* [pandas] (http://pandas.pydata.org)
* [biopython] (http://biopython.org)


